5:"$Sreact.fragment"
6:I[8700,["501","static/chunks/c16f53c3-3b8175db5e37d586.js","231","static/chunks/231-8ed682081319d2df.js","514","static/chunks/514-04a7040e7e165315.js","185","static/chunks/app/layout-9571a2c69f2e6c13.js"],"ThemeProviders"]
7:I[4080,["501","static/chunks/c16f53c3-3b8175db5e37d586.js","231","static/chunks/231-8ed682081319d2df.js","514","static/chunks/514-04a7040e7e165315.js","185","static/chunks/app/layout-9571a2c69f2e6c13.js"],""]
8:I[6766,["501","static/chunks/c16f53c3-3b8175db5e37d586.js","231","static/chunks/231-8ed682081319d2df.js","514","static/chunks/514-04a7040e7e165315.js","185","static/chunks/app/layout-9571a2c69f2e6c13.js"],"KBarSearchProvider"]
9:I[231,["231","static/chunks/231-8ed682081319d2df.js","173","static/chunks/173-da2e96dd468954d2.js","797","static/chunks/app/blog/%5B...slug%5D/page-331f587205920428.js"],""]
a:I[509,["501","static/chunks/c16f53c3-3b8175db5e37d586.js","231","static/chunks/231-8ed682081319d2df.js","514","static/chunks/514-04a7040e7e165315.js","185","static/chunks/app/layout-9571a2c69f2e6c13.js"],"KBarButton"]
b:I[1398,["501","static/chunks/c16f53c3-3b8175db5e37d586.js","231","static/chunks/231-8ed682081319d2df.js","514","static/chunks/514-04a7040e7e165315.js","185","static/chunks/app/layout-9571a2c69f2e6c13.js"],"default"]
c:I[8976,["501","static/chunks/c16f53c3-3b8175db5e37d586.js","231","static/chunks/231-8ed682081319d2df.js","514","static/chunks/514-04a7040e7e165315.js","185","static/chunks/app/layout-9571a2c69f2e6c13.js"],"default"]
d:I[9275,[],""]
e:I[1343,[],""]
10:I[3120,[],"OutletBoundary"]
12:I[3120,[],"MetadataBoundary"]
14:I[3120,[],"ViewportBoundary"]
16:I[6130,[],""]
1:HL["/_next/static/media/2d141e1a38819612-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
2:HL["/_next/static/css/7206d3316422b72f.css","style"]
3:HL["/_next/static/css/bf08393494c6d8a1.css","style"]
4:HL["/_next/static/css/e36d2c8a31781d2e.css","style"]
0:{"P":null,"b":"sgWsyVdTGdFp3zW7eKJ6w","p":"","c":["","blog","docker-intro-with-do"],"i":false,"f":[[["",{"children":["blog",{"children":[["slug","docker-intro-with-do","c"],{"children":["__PAGE__?{\"slug\":[\"docker-intro-with-do\"]}",{}]}]}]},"$undefined","$undefined",true],["",["$","$5","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/7206d3316422b72f.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/bf08393494c6d8a1.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en-gb","className":"__variable_0aa4ae scroll-smooth","suppressHydrationWarning":true,"children":[["$","link",null,{"rel":"apple-touch-icon","sizes":"76x76","href":"/static/favicons/apple-touch-icon.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"32x32","href":"/static/favicons/favicon-32x32.png"}],["$","link",null,{"rel":"icon","type":"image/png","sizes":"16x16","href":"/static/favicons/favicon-16x16.png"}],["$","link",null,{"rel":"manifest","href":"/static/favicons/site.webmanifest"}],["$","link",null,{"rel":"mask-icon","href":"/static/favicons/safari-pinned-tab.svg","color":"#5bbad5"}],["$","meta",null,{"name":"msapplication-TileColor","content":"#000000"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: light)","content":"#fff"}],["$","meta",null,{"name":"theme-color","media":"(prefers-color-scheme: dark)","content":"#000"}],["$","link",null,{"rel":"alternate","type":"application/rss+xml","href":"/feed.xml"}],["$","body",null,{"className":"bg-white pl-[calc(100vw-100%)] text-black antialiased dark:bg-gray-950 dark:text-white","children":["$","$L6",null,{"children":[["$undefined","$undefined","$undefined",["$","$L7",null,{"async":true,"defer":true,"src":"https://analytics.umami.is/script.js"}],"$undefined","$undefined"],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":[["$","$L8",null,{"kbarConfig":{"searchDocumentsPath":"/search.json"},"children":[["$","header",null,{"className":"flex items-center w-full bg-white dark:bg-gray-950 justify-between py-10","children":[["$","$L9",null,{"className":"break-words","href":"/","aria-label":"Colin Riddell","children":["$","div",null,{"className":"flex items-center justify-between","children":[["$","div",null,{"className":"mr-3","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","xmlnsXlink":"http://www.w3.org/1999/xlink","width":53.87,"height":43.61,"viewBox":"344.564 330.278 111.737 91.218","children":[["$","defs",null,{"children":[["$","linearGradient",null,{"id":"logo_svg__b","x1":420.97,"x2":420.97,"y1":331.28,"y2":418.5,"gradientUnits":"userSpaceOnUse","children":[["$","stop",null,{"offset":"0%","style":{"stopColor":"#06b6d4","stopOpacity":1}}],["$","stop",null,{"offset":"100%","style":{"stopColor":"#67e8f9","stopOpacity":1}}]]}],["$","linearGradient",null,{"id":"logo_svg__d","x1":377.89,"x2":377.89,"y1":331.28,"y2":418.5,"gradientUnits":"userSpaceOnUse","children":[["$","stop",null,{"offset":"0%","style":{"stopColor":"#06b6d4","stopOpacity":1}}],["$","stop",null,{"offset":"100%","style":{"stopColor":"#67e8f9","stopOpacity":1}}]]}],["$","path",null,{"id":"logo_svg__a","d":"M453.3 331.28v28.57l-64.66 58.65v-30.08z"}],["$","path",null,{"id":"logo_svg__c","d":"M410.23 331.28v28.57l-64.67 58.65v-30.08z"}]]}],["$","use",null,{"xlinkHref":"#logo_svg__a","fill":"url(#logo_svg__b)"}],["$","use",null,{"xlinkHref":"#logo_svg__c","fill":"url(#logo_svg__d)"}]]}]}],["$","div",null,{"className":"hidden h-6 text-2xl font-semibold sm:block","children":"Colin Riddell"}]]}]}],["$","div",null,{"className":"flex items-center space-x-4 leading-5 sm:space-x-6","children":[["$","div",null,{"className":"no-scrollbar hidden max-w-40 items-center space-x-4 overflow-x-auto sm:flex sm:space-x-6 md:max-w-72 lg:max-w-96","children":[["$","$L9","Blog",{"className":"block font-medium text-gray-900 hover:text-primary-500 dark:text-gray-100 dark:hover:text-primary-400","href":"/blog","children":"Blog"}],["$","$L9","Tags",{"className":"block font-medium text-gray-900 hover:text-primary-500 dark:text-gray-100 dark:hover:text-primary-400","href":"/tags","children":"Tags"}],["$","$L9","Projects",{"className":"block font-medium text-gray-900 hover:text-primary-500 dark:text-gray-100 dark:hover:text-primary-400","href":"/projects","children":"Projects"}],["$","$L9","About",{"className":"block font-medium text-gray-900 hover:text-primary-500 dark:text-gray-100 dark:hover:text-primary-400","href":"/about","children":"About"}]]}],["$","$La",null,{"aria-label":"Search","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","fill":"none","viewBox":"0 0 24 24","strokeWidth":1.5,"stroke":"currentColor","className":"h-6 w-6 text-gray-900 hover:text-primary-500 dark:text-gray-100 dark:hover:text-primary-400","children":["$","path",null,{"strokeLinecap":"round","strokeLinejoin":"round","d":"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"}]}]}],["$","$Lb",null,{}],["$","$Lc",null,{}]]}]]}],["$","main",null,{"className":"mb-auto","children":["$","$Ld",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$Le",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","div",null,{"className":"flex flex-col items-start justify-start md:mt-24 md:flex-row md:items-center md:justify-center md:space-x-6","children":[["$","div",null,{"className":"space-x-2 pb-8 pt-6 md:space-y-5","children":["$","h1",null,{"className":"text-6xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 md:border-r-2 md:px-6 md:text-8xl md:leading-14","children":"404"}]}],["$","div",null,{"className":"max-w-md","children":[["$","p",null,{"className":"mb-4 text-xl font-bold leading-normal md:text-2xl","children":"Sorry we couldn't find this page."}],["$","p",null,{"className":"mb-8","children":"But dont worry, you can find plenty of other things on our homepage."}],["$","$L9",null,{"className":"focus:shadow-outline-blue inline rounded-lg border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium leading-5 text-white shadow transition-colors duration-150 hover:bg-blue-700 focus:outline-none dark:hover:bg-blue-500","href":"/","children":"Back to homepage"}]]}]]}],"notFoundStyles":[]}]}]]}],["$","footer",null,{"children":["$","div",null,{"className":"mt-16 flex flex-col items-center","children":[["$","div",null,{"className":"mb-3 flex space-x-4","children":[null,["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://github.com/colin-riddell","children":[["$","span",null,{"className":"sr-only","children":"github"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":[["$","title",null,{"children":"GitHub"}],["$","path",null,{"d":"M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"}]]}]]}],null,null,["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://www.linkedin.com/in/cjriddell/","children":[["$","span",null,{"className":"sr-only","children":"linkedin"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":[["$","title",null,{"children":"Linkedin"}],["$","path",null,{"d":"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"}]]}]]}],null,null,["$","a",null,{"className":"text-sm text-gray-500 transition hover:text-gray-600","target":"_blank","rel":"noopener noreferrer","href":"https://twitter.com/colin-riddell","children":[["$","span",null,{"className":"sr-only","children":"x"}],["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","viewBox":"0 0 24 24","className":"fill-current text-gray-700 hover:text-primary-500 dark:text-gray-200 dark:hover:text-primary-400 h-6 w-6","children":[["$","title",null,{"children":"X"}],["$","path",null,{"d":"M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"}]]}]]}],null,null,null]}],["$","div",null,{"className":"mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400","children":[["$","div",null,{"children":"Colin Riddell"}],["$","div",null,{"children":" • "}],["$","div",null,{"children":"© 2025"}],["$","div",null,{"children":" • "}],["$","$L9",null,{"className":"break-words","href":"/","children":"Colin Riddell - Blog"}]]}],["$","div",null,{"className":"mb-8 text-sm text-gray-500 dark:text-gray-400","children":["$","a",null,{"className":"break-words","target":"_blank","rel":"noopener noreferrer","href":"https://github.com/timlrx/tailwind-nextjs-starter-blog","children":"Tailwind Nextjs Theme"}]}]]}]}]]}]]}]}]]}]]}],{"children":["blog",["$","$5","c",{"children":[null,["$","$Ld",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$Le",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":[["slug","docker-intro-with-do","c"],["$","$5","c",{"children":[null,["$","$Ld",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","$0:f:0:1:2:children:2:children:0","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$Le",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]]}],{"children":["__PAGE__",["$","$5","c",{"children":["$Lf",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/e36d2c8a31781d2e.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L10",null,{"children":"$L11"}]]}],{},null]},null]},null]},null],["$","$5","h",{"children":[null,["$","$5","QV3yRMCcBk4IZP1JkEvCf",{"children":[["$","$L12",null,{"children":"$L13"}],["$","$L14",null,{"children":"$L15"}],["$","meta",null,{"name":"next-size-adjust"}]]}]]}]]],"m":"$undefined","G":["$16","$undefined"],"s":false,"S":true}
17:I[4347,["231","static/chunks/231-8ed682081319d2df.js","173","static/chunks/173-da2e96dd468954d2.js","797","static/chunks/app/blog/%5B...slug%5D/page-331f587205920428.js"],"default"]
18:I[8173,["231","static/chunks/231-8ed682081319d2df.js","173","static/chunks/173-da2e96dd468954d2.js","797","static/chunks/app/blog/%5B...slug%5D/page-331f587205920428.js"],"Image"]
19:I[408,["231","static/chunks/231-8ed682081319d2df.js","173","static/chunks/173-da2e96dd468954d2.js","797","static/chunks/app/blog/%5B...slug%5D/page-331f587205920428.js"],"default"]
1a:I[9629,["231","static/chunks/231-8ed682081319d2df.js","173","static/chunks/173-da2e96dd468954d2.js","797","static/chunks/app/blog/%5B...slug%5D/page-331f587205920428.js"],"default"]
f:[["$","script",null,{"type":"application/ld+json","dangerouslySetInnerHTML":{"__html":"{\"@context\":\"https://schema.org\",\"@type\":\"BlogPosting\",\"headline\":\"Deploying to Cloud with DigitalOcean + Docker\",\"datePublished\":\"2019-09-19T17:19:14.000Z\",\"dateModified\":\"2019-09-19T17:19:14.000Z\",\"image\":\"/static/images/twitter-card.png\",\"url\":\"https://colin-riddell.github.io//blog/docker-intro-with-do\",\"author\":[{\"@type\":\"Person\",\"name\":\"Colin Riddell\"}]}"}}],["$","section",null,{"className":"mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0","children":[["$","$L17",null,{}],["$","article",null,{"children":["$","div",null,{"className":"xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700","children":[["$","header",null,{"className":"pt-6 xl:pb-6","children":["$","div",null,{"className":"space-y-1 text-center","children":[["$","dl",null,{"className":"space-y-10","children":["$","div",null,{"children":[["$","dt",null,{"className":"sr-only","children":"Published on"}],["$","dd",null,{"className":"text-base font-medium leading-6 text-gray-500 dark:text-gray-400","children":["$","time",null,{"dateTime":"2019-09-19T17:19:14.000Z","children":"Thursday, 19 September 2019"}]}]]}]}],["$","div",null,{"children":["$","h1",null,{"className":"text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14","children":"Deploying to Cloud with DigitalOcean + Docker"}]}]]}]}],["$","div",null,{"className":"grid-rows-[auto_1fr] divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6 xl:divide-y-0","children":[["$","dl",null,{"className":"pb-10 pt-6 xl:border-b xl:border-gray-200 xl:pt-11 xl:dark:border-gray-700","children":[["$","dt",null,{"className":"sr-only","children":"Authors"}],["$","dd",null,{"children":["$","ul",null,{"className":"flex flex-wrap justify-center gap-4 sm:space-x-12 xl:block xl:space-x-0 xl:space-y-8","children":[["$","li","Colin Riddell",{"className":"flex items-center space-x-2","children":[["$","$L18",null,{"src":"/static/images/colin.jpg","width":38,"height":38,"alt":"avatar","className":"h-10 w-10 rounded-full"}],["$","dl",null,{"className":"whitespace-nowrap text-sm font-medium leading-5","children":[["$","dt",null,{"className":"sr-only","children":"Name"}],["$","dd",null,{"className":"text-gray-900 dark:text-gray-100","children":"Colin Riddell"}],["$","dt",null,{"className":"sr-only","children":"Twitter"}],["$","dd",null,{"children":"$undefined"}]]}]]}]]}]}]]}],["$","div",null,{"className":"divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0","children":[["$","div",null,{"className":"prose max-w-none pb-8 pt-10 dark:prose-invert","children":[["$","p",null,{"children":"Containerization allows development teams to move fast, deploy software efficiently, and operate at an unprecedented scale."}],["$","hr",null,{}],["$","ul",null,{"children":[["$","li",null,{"children":"They are small"}],["$","li",null,{"children":"They are fast"}],["$","li",null,{"children":"They consume no more engergy than running an application"}],["$","li",null,{"children":"They take up 100's of times less space and memory than virtual machines"}]]}],["$","h2",null,{"className":"content-header","id":"setup","children":[["$","a",null,{"className":"break-words","href":"#setup","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Setup"]}],["$","h3",null,{"className":"content-header","id":"optional-get-a-do-account","children":[["$","a",null,{"className":"break-words","href":"#optional-get-a-do-account","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],["$","em",null,{"children":"Optional"}]," Get a DO account"]}],["$","p",null,{"children":[["$","a",null,{"className":"break-words","target":"_blank","rel":"noopener noreferrer","href":"https://m.do.co/c/e224d565e5ec","children":"https://m.do.co/c/e224d565e5ec"}]," - this link gives 100 USD credit."]}],["$","h3",null,{"className":"content-header","id":"install-docker---do-before-starting","children":[["$","a",null,{"className":"break-words","href":"#install-docker---do-before-starting","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Install Docker - do before starting"]}],["$","p",null,{"children":["$","a",null,{"className":"break-words","target":"_blank","rel":"noopener noreferrer","href":"https://docs.docker.com/docker-for-mac/install/","children":"Docker Download - Mac"}]}],["$","p",null,{"children":"OR"}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":[["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"curl"}]," https://download.docker.com/mac/stable/Docker.dmg ",["$","span",null,{"className":"token parameter variable","children":"--output"}]," Docker.dmg ",["$","span",null,{"className":"token operator","children":"&&"}]," ",["$","span",null,{"className":"token function","children":"open"}]," Docker.dmg\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","h2",null,{"className":"content-header","id":"get-started---docker","children":[["$","a",null,{"className":"break-words","href":"#get-started---docker","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Get Started - Docker"]}],["$","h3",null,{"className":"content-header","id":"what-is-docker","children":[["$","a",null,{"className":"break-words","href":"#what-is-docker","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"What is Docker"]}],["$","p",null,{"children":"Docker is a container engine application that runs on Mac, Windows and Linux that allows us to run Containers"}],["$","h3",null,{"className":"content-header","id":"what-are-containers","children":[["$","a",null,{"className":"break-words","href":"#what-are-containers","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"What are containers?"]}],["$","p",null,{"children":"Containers are operating systems that run virtually within a host system such as Linux, Mac or Windows. Host systems are typically servers in the cloud or development laptops running locally."}],["$","p",null,{"children":"Containers are typically very small taking up just enough memory and disk space to perform their function."}],["$","p",null,{"children":"They are ephemeral, meaning they are designed to be short-lived and never permanent."}],["$","p",null,{"children":"These small short-lived operating systems are for running processes on the host in such a way that the host doesn't need to know about or provide any of the dependencies of the application directly."}],["$","p",null,{"children":"For example if we wish to run an express.js application there are two choices. Without the container (as normal) - where we'd need to install the dependencies on the host machine (server, laptop etc). Or with a container where the dependencies would be installed in the container."}],["$","p",null,{"children":"Running an application in a container vs running on the host gives consistency between running all the various places that app might need to run. We might need to run something on several dev' machines, test servers, integration servers and one or more production servers."}],["$","p",null,{"children":"Since containers are small environments for our applications to run, we can use containers to scale the application horizontally."}],["$","h3",null,{"className":"content-header","id":"what-are-containers-technically","children":[["$","a",null,{"className":"break-words","href":"#what-are-containers-technically","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"What are containers: Technically"]}],["$","p",null,{"children":["To understand what containers ",["$","em",null,{"children":"are"}]," we need to understand a little Linux. The Linux OS is as simple as:"]}],["$","ul",null,{"children":[["$","li",null,{"children":"A filesystem (files)"}],["$","li",null,{"children":"A kernel (core process)"}],["$","li",null,{"children":"Processes (running applications)"}]]}],["$","p",null,{"children":["A container is all of these things running together virtually to give the ",["$","em",null,{"children":"illusion"}]," that they are running on a separate intependent operating system."]}],["$","h4",null,{"className":"content-header","id":"how","children":[["$","a",null,{"className":"break-words","href":"#how","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"How?"]}],["$","h5",null,{"className":"content-header","id":"chroot","children":[["$","a",null,{"className":"break-words","href":"#chroot","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"chroot"]}],["$","p",null,{"children":"The linux kernel supports mapping a filesystem within a filesystem to a specific process as a particular user."}],["$","h5",null,{"className":"content-header","id":"cgroups","children":[["$","a",null,{"className":"break-words","href":"#cgroups","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"cgroups"]}],["$","p",null,{"children":"cgroups, short for control groups, allow kernel imposed isolation on resources like memory and CPU. After all, what’s the point of isolating processes they can still kill neighbors by hogging RAM."}],["$","h5",null,{"className":"content-header","id":"nsenter","children":[["$","a",null,{"className":"break-words","href":"#nsenter","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"nsenter"]}],["$","p",null,{"children":"We need networking. NSEnter works with the kernel to help create virtual networking namespaces."}],["$","h2",null,{"className":"content-header","id":"docker","children":[["$","a",null,{"className":"break-words","href":"#docker","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Docker"]}],["$","p",null,{"children":[["$","strong",null,{"children":"Docker"}]," makes use of all these system-level tools to create contained systems that run within the host, but are isolated completely from the host and other containers."]}],["$","p",null,{"children":["Docker brings together a lot more than ",["$","code",null,{"children":"chroot"}],", ",["$","code",null,{"children":"cgroups"}]," and ",["$","code",null,{"children":"nsenter"}]," - but these alone are enough to give the basis of running an Operating System within an Operating System."]}],["$","h3",null,{"className":"content-header","id":"running-a-container","children":[["$","a",null,{"className":"break-words","href":"#running-a-container","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Running a container"]}],["$","$L19",null,{"className":"language-js","children":["$","code",null,{"className":"code-highlight language-js","children":["$","span",null,{"className":"code-line","children":["docker run ",["$","span",null,{"className":"token operator","children":"-"}],"it ubuntu bash\n"]}]}]}],["$","p",null,{"children":["This is the docker run command. ",["$","code",null,{"children":"-it"}]," is ",["$","code",null,{"children":"-i"}]," and ",["$","code",null,{"children":"-t"}],". ",["$","code",null,{"children":"-i"}]," asks for network access from the host and ",["$","code",null,{"children":"-t"}]," asks for a terminal command to be run."]}],["$","p",null,{"children":[["$","code",null,{"children":"ubuntu"}]," is the ",["$","strong",null,{"children":"image"}]," we wish to use. Docker pulls common images from the online Docker Registry. This is a repository of official images that people contribute docker images of various Operating Systems and applications. Nearly every application you can imagine has a Docker image on there."]}],["$","p",null,{"children":[["$","code",null,{"children":"bash"}]," is the command we wish to run. This simply runs the ",["$","code",null,{"children":"bash"}]," shell. ",["$","strong",null,{"children":"Why not run zsh"}]," - it's common practice to run bash as it's universally available on nearly every Linux distribution."]}],["$","p",null,{"children":[["$","strong",null,{"children":"Running that command..."}]," we're now in a container. Wasn't that fast? We can do whatever we want here :)"]}],["$","h2",null,{"className":"content-header","id":"node-in-container","children":[["$","a",null,{"className":"break-words","href":"#node-in-container","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Node in container"]}],["$","h3",null,{"className":"content-header","id":"running-without-container","children":[["$","a",null,{"className":"break-words","href":"#running-without-container","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Running without container"]}],["$","p",null,{"children":"Running an express.js application without docker is as how we would run it normally."}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"npm"}]," start ",["$","span",null,{"className":"token comment","children":"# in the server"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["mongod ",["$","span",null,{"className":"token comment","children":"# in a separate tab"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"npm"}]," run serve   ",["$","span",null,{"className":"token comment","children":"#in the client directory"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","p",null,{"children":"This is fine when we're developing locally.. but even in that case we have three tabs to run one application."}],["$","p",null,{"children":"Docker containers allow us to do this more easily."}],["$","h3",null,{"className":"content-header","id":"with-a-container","children":[["$","a",null,{"className":"break-words","href":"#with-a-container","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"With a container"]}],["$","$L19",null,{"className":"language-js","children":["$","code",null,{"className":"code-highlight language-js","children":["$","span",null,{"className":"code-line","children":["docker run ",["$","span",null,{"className":"token operator","children":"-"}],"it ",["$","span",null,{"className":"token operator","children":"--"}],"rm ",["$","span",null,{"className":"token operator","children":"--"}],"name auth_app ",["$","span",null,{"className":"token operator","children":"-"}],"v ",["$","span",null,{"className":"token string","children":"\"$PWD\""}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token operator","children":"/"}],"usr",["$","span",null,{"className":"token operator","children":"/"}],"src",["$","span",null,{"className":"token operator","children":"/"}],"auth_app ",["$","span",null,{"className":"token operator","children":"-"}],"w ",["$","span",null,{"className":"token operator","children":"/"}],"usr",["$","span",null,{"className":"token operator","children":"/"}],"src",["$","span",null,{"className":"token operator","children":"/"}],"auth_app node",["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"8"}]," npm install",["$","span",null,{"className":"token punctuation","children":";"}]," npm start\n"]}]}]}],["$","p",null,{"children":["In another tab we can do ",["$","code",null,{"children":"docker ps"}]," (docker list running containers), to see it running."]}],["$","p",null,{"children":"This will work, but then fail to connect to the MongoDB."}],["$","p",null,{"children":"To solve this we could open another tab then do another long run command to find a mongod image, pull that and run it, but we might still have issues with that and typing these huge run commands isn't nice."}],["$","p",null,{"children":["$","strong",null,{"children":"Ideally, we'd have each thing in its own container. The back-end, the front-end and the mongodb"}]}],["$","h2",null,{"className":"content-header","id":"images","children":[["$","a",null,{"className":"break-words","href":"#images","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Images"]}],["$","p",null,{"children":["To save us from typing really long commands to use the Docker API, we can use a more script-like code to create containers. To create containers we first need to make a docker ",["$","strong",null,{"children":"image"}]]}],["$","h2",null,{"className":"content-header","id":"images-vs-containers","children":[["$","a",null,{"className":"break-words","href":"#images-vs-containers","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Images vs Containers"]}],["$","p",null,{"children":["$","strong",null,{"children":"What's the difference between a container and an image - in docker?"}]}],["$","p",null,{"children":[["$","strong",null,{"children":"Docker Container"}]," is a ",["$","em",null,{"children":"running"}]," docker ",["$","strong",null,{"children":"image"}],"."]}],["$","p",null,{"children":"thus"}],["$","p",null,{"children":[["$","strong",null,{"children":"Docker Image"}]," is like a blueprint for a container. It is literally just a zip (actually ",["$","code",null,{"children":"tar.gz"}],") of the filesystem that the container should use."]}],["$","h3",null,{"className":"content-header","id":"creating-an-image","children":[["$","a",null,{"className":"break-words","href":"#creating-an-image","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Creating an Image"]}],["$","p",null,{"children":["The ",["$","strong",null,{"children":"Dockerfile"}]," gives us a way to script the creation of an ",["$","strong",null,{"children":"image"}],"."]}],["$","p",null,{"children":"Let's create our first Dockerfile to run the bucket list app."}],["$","p",null,{"children":["At the same level as the ",["$","code",null,{"children":"package.json"}]," in the bucket list node project:"]}],["$","$L19",null,{"className":"language-dockerfile","children":["$","code",null,{"className":"code-highlight language-Dockerfile","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"#Dockerfile"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"FROM"}]," node:8"]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"WORKDIR"}]," /usr/src/auth-app/"]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"COPY"}]," . ."]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"RUN"}]," npm install"]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"EXPOSE"}]," 3000"]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token instruction","children":[["$","span",null,{"className":"token keyword","children":"CMD"}]," [ ",["$","span",null,{"className":"token string","children":"\"npm\""}],", ",["$","span",null,{"className":"token string","children":"\"start\""}]," ]"]}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","h4",null,{"className":"content-header","id":"dockerfile-commands-broken-down","children":[["$","a",null,{"className":"break-words","href":"#dockerfile-commands-broken-down","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Dockerfile commands broken down"]}],["$","ul",null,{"children":[["$","li",null,{"children":[["$","code",null,{"children":"FROM node:8"}]," - Docker allows us to create images but use other images as the starting point. You can think of this as being ",["$","em",null,{"children":"like"}]," inheriting between images. If we use the official node.js as our ",["$","em",null,{"children":"base image"}],", then we will get a container that already has node installed, specifically version ",["$","strong",null,{"children":"8"}]]}],["$","li",null,{"children":[["$","code",null,{"children":"WORKDIR"}]," - We need this to specify a default working directory ",["$","strong",null,{"children":"in the container"}],", not on the host machine. Once this is set, that means the ",["$","code",null,{"children":"."}]," or the ",["$","code",null,{"children":"pwd"}]," in the container is set to this location. When the container starts it will start in this directory. If that directory doesn't exist it will be created."]}],["$","li",null,{"children":[["$","code",null,{"children":"COPY <src> <dest>"}]," - Is used to copy files ",["$","strong",null,{"children":"from the host to the container"}],". ",["$","code",null,{"children":"<src>"}]," is a location on the host. ",["$","code",null,{"children":"<dest>"}]," is a location on the container. We use ",["$","code",null,{"children":"."}]," as we've already set a ",["$","code",null,{"children":"WORKDIR"}],"."]}],["$","li",null,{"children":[["$","code",null,{"children":"RUN npm install"}]," - Runs the given command on the container as part of the ",["$","strong",null,{"children":"build"}]," process for creating that image. This is not to be confused with ",["$","code",null,{"children":"CMD"}]," which sets up a command to run when the container is launched. We can have as many ",["$","code",null,{"children":"RUN"}]," lines as we require. It's very common to have ",["$","code",null,{"children":"RUN"}]," lines that install dependencies."]}],["$","li",null,{"children":[["$","code",null,{"children":"EXPOSE 3000"}]," - By default containers have all their I/O including networking shut off from the host and other containers. Our node app will run on 3000, so we open 3000 in order to see it working."]}],["$","li",null,{"children":[["$","code",null,{"children":"CMD [ \"npm\", \"start\" ]"}]," - This is where we specify the container ",["$","strong",null,{"children":"entrypoint"}],". This is what's run when the container starts. Remember if a container's ",["$","code",null,{"children":"CMD"}]," is simply ",["$","code",null,{"children":"ls"}]," it will just run that command and exit. If it's something like a web server it will run that while the container is running. ",["$","strong",null,{"children":["As soon as the process started by ",["$","code",null,{"children":"CMD"}]," exits, the container also exits."]}]]}]]}],["$","h3",null,{"className":"content-header","id":"exclude-the-node_modules-from-being-copied","children":[["$","a",null,{"className":"break-words","href":"#exclude-the-node_modules-from-being-copied","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Exclude the ",["$","code",null,{"children":"node_modules"}]," from being copied"]}],["$","p",null,{"children":["Cretate a ",["$","code",null,{"children":"dockerignore"}]," file and add - we don't want"]}],["$","$L19",null,{"className":"language-js","children":["$","code",null,{"className":"code-highlight language-js","children":["$","span",null,{"className":"code-line","children":"node_modules\n"}]}]}],["$","h3",null,{"className":"content-header","id":"buidling--running-the-dockerfile","children":[["$","a",null,{"className":"break-words","href":"#buidling--running-the-dockerfile","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Buidling + Running the Dockerfile"]}],["$","p",null,{"children":["We can build that Dockerfile into an image called ",["$","code",null,{"children":"bucket_list"}]," with the command:"]}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"docker"}]," build ",["$","span",null,{"className":"token builtin class-name","children":"."}]," ",["$","span",null,{"className":"token parameter variable","children":"-t"}]," auth-app\n"]}]}]}],["$","p",null,{"children":["We should be able to see the image listed when we do ",["$","code",null,{"children":"docker images"}],"."]}],["$","p",null,{"children":"To run the resulting image:"}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"docker"}]," run ",["$","span",null,{"className":"token parameter variable","children":"-p3000:3000"}]," auth-app\n"]}]}]}],["$","p",null,{"children":[["$","strong",null,{"children":"Why did you need to specify the port?"}]," The port setting we specified in the Dockerfile is just the one we want to ensure the image will allow us to expose. We still need to ask the run command to expose it."]}],["$","p",null,{"children":[["$","a",null,{"className":"break-words","target":"_blank","rel":"noopener noreferrer","href":"http://localhost:3000/","children":"http://localhost:3000/"}]," should now have the running app. ",["$","strong",null,{"children":"But we still need a MongoDB database"}],". We'll look at doing this in the next section..."]}],["$","h2",null,{"className":"content-header","id":"multiple-containers","children":[["$","a",null,{"className":"break-words","href":"#multiple-containers","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Multiple containers"]}],["$","p",null,{"children":["We ",["$","em",null,{"children":"could"}]," create a MongoD Dockerfile and create a container for it like that, but that requires us to run two containers at the same time in different tabs... so let's instead use ",["$","code",null,{"children":"docker-compose"}],"."]}],["$","p",null,{"children":[["$","strong",null,{"children":"docker-compose"}]," allows us to create a scheme in ",["$","code",null,{"children":"yaml"}]," to orchistrate the running of multiple containers and be able to turn them all of, or all on at the same time. This way, we could \"spin up\" our mongod, client and server in one command."]}],["$","p",null,{"children":[["$","strong",null,{"children":"docker-compose"}]," lets us build images and start containers through one nice easy to use command line tool and an easy to understand yaml configuration."]}],["$","p",null,{"children":"We still use Dockerfiles.."}],["$","p",null,{"children":"Let's build a docker-compose."}],["$","$L19",null,{"className":"language-yaml","children":["$","code",null,{"className":"code-highlight language-yaml","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"#docker-compose.yml"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token atrule key","children":"version"}],["$","span",null,{"className":"token punctuation","children":":"}]," ",["$","span",null,{"className":"token string","children":"'3.1'"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token atrule key","children":"services"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token atrule key","children":"auth_server"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"container_name"}],["$","span",null,{"className":"token punctuation","children":":"}]," ",["$","span",null,{"className":"token string","children":"'auth_server'"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"ports"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token punctuation","children":"-"}]," 3000",["$","span",null,{"className":"token punctuation","children":":"}],["$","span",null,{"className":"token number","children":"3000"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"build"}],["$","span",null,{"className":"token punctuation","children":":"}]," ./server/\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"links"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["       ",["$","span",null,{"className":"token punctuation","children":"-"}]," mongoservice\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"restart"}],["$","span",null,{"className":"token punctuation","children":":"}]," on",["$","span",null,{"className":"token punctuation","children":"-"}],"failure\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token atrule key","children":"mongoservice"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"image"}],["$","span",null,{"className":"token punctuation","children":":"}]," mongo",["$","span",null,{"className":"token punctuation","children":":"}],"latest\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"container_name"}],["$","span",null,{"className":"token punctuation","children":":"}]," ",["$","span",null,{"className":"token string","children":"\"mongoservice\""}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"environment"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token punctuation","children":"-"}]," MONGO_DATA_DIR=/data/db\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token punctuation","children":"-"}]," MONGO_LOG_DIR=/dev/null\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"volumes"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["     ",["$","span",null,{"className":"token punctuation","children":"-"}]," ./data/db",["$","span",null,{"className":"token punctuation","children":":"}],"/data/db\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"ports"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token punctuation","children":"-"}]," 27017",["$","span",null,{"className":"token punctuation","children":":"}],["$","span",null,{"className":"token number","children":"27017"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"command"}],["$","span",null,{"className":"token punctuation","children":":"}]," mongod ",["$","span",null,{"className":"token punctuation","children":"-"}],["$","span",null,{"className":"token punctuation","children":"-"}],"smallfiles\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token atrule key","children":"restart"}],["$","span",null,{"className":"token punctuation","children":":"}]," on",["$","span",null,{"className":"token punctuation","children":"-"}],"failure\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","p",null,{"children":["File structure changes to support ",["$","code",null,{"children":"docker-compose"}]," microservices."]}],["$","p",null,{"children":["Let's make a new directory called ",["$","code",null,{"children":"services"}],", ",["$","code",null,{"children":"client"}],", ",["$","code",null,{"children":"server"}]," and ",["$","code",null,{"children":"docker-compose.yml"}]," into it."]}],["$","$L19",null,{"className":"language-js","children":["$","code",null,{"className":"code-highlight language-js","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"."}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token property-access","children":"└──"}]," services\n"]}],["$","span",null,{"className":"code-line","children":"    ├── client\n"}],["$","span",null,{"className":"code-line","children":["    │   ├── ",["$","span",null,{"className":"token constant","children":"README"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"md"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    │   ├── babel",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"config"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"js"}],"\n"]}],["$","span",null,{"className":"code-line","children":"    │   ├── node_modules\n"}],["$","span",null,{"className":"code-line","children":["    │   ├── ",["$","span",null,{"className":"token keyword","children":"package"}],["$","span",null,{"className":"token operator","children":"-"}],"lock",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"json"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    │   ├── ",["$","span",null,{"className":"token keyword","children":"package"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"json"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    │   ├── postcss",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"config"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"js"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    │   ├── ",["$","span",null,{"className":"token keyword","children":"public"}],"\n"]}],["$","span",null,{"className":"code-line","children":"    │   └── src\n"}],["$","span",null,{"className":"code-line","children":["    ├── docker",["$","span",null,{"className":"token operator","children":"-"}],"compose",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"yml"}],"\n"]}],["$","span",null,{"className":"code-line","children":"    └── server\n"}],["$","span",null,{"className":"code-line","children":["        ├── ",["$","span",null,{"className":"token maybe-class-name","children":"Dockerfile"}],"\n"]}],["$","span",null,{"className":"code-line","children":"        ├── models\n"}],["$","span",null,{"className":"code-line","children":"        ├── node_modules\n"}],["$","span",null,{"className":"code-line","children":["        ├── ",["$","span",null,{"className":"token keyword","children":"package"}],["$","span",null,{"className":"token operator","children":"-"}],"lock",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"json"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ├── ",["$","span",null,{"className":"token keyword","children":"package"}],["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"json"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        └── server",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"js"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","p",null,{"children":["Keeping the ",["$","code",null,{"children":"docker-compose"}]," at a level higher than the services that it uses means it's easier to add more services later on, and have docker-compose orchestrate them all."]}],["$","h3",null,{"className":"content-header","id":"run-it","children":[["$","a",null,{"className":"break-words","href":"#run-it","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Run it"]}],["$","p",null,{"children":[["$","code",null,{"children":"docker-compose build"}]," now builds all our images. Looks through any services in the docker-compose file that have a ",["$","code",null,{"children":"build"}]," attribute and builds them accordingly."]}],["$","p",null,{"children":["In our case it just builds the Dockerfile we've pointed out in ",["$","code",null,{"children":"./bucket_list_service/"}]," directory as the place to build the image for the bucket_list_service."]}],["$","p",null,{"children":"For mongodb, we're using the vanilla official mongo docker image which is already built for us. So we can just ask to pull and use that."}],["$","p",null,{"children":[["$","code",null,{"children":"docker-compose up"}]," is the command we use to ask it to run all these containers at once."]}],["$","p",null,{"children":["$","strong",null,{"children":"We now find some problems when starting the app."}]}],["$","p",null,{"children":"These are:"}],["$","ul",null,{"children":[["$","li",null,{"children":"The bucket_list_service starts really quickly and tries to connect to mongodb before it's even ready!"}],["$","li",null,{"children":"The bucket_list_service doesn't find the mongodb service at all."}]]}],["$","p",null,{"children":["$","strong",null,{"children":"We can fix these by doing:"}]}],["$","p",null,{"children":["In ",["$","code",null,{"children":"server.js"}]," we need to ask node.js to exit when it doesn't connect to mongodb. Doing this means ",["$","strong",null,{"children":"the container will fail too."}]," Then it should immediately restart becuase we have ",["$","code",null,{"children":"restart: on-failure"}]," option on that service outline in ",["$","code",null,{"children":"docker-compose.yml"}],". Doing this it does restart each time, but we still have problems finding it all."]}],["$","p",null,{"children":"We will fix this in the next section!"}],["$","h2",null,{"className":"content-header","id":"networking-with-docker","children":[["$","a",null,{"className":"break-words","href":"#networking-with-docker","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Networking with Docker"]}],["$","p",null,{"children":"When we have multiple containers Docker creates a virual network for them all to find each-other. We do still need to explicitly link them, but the network is created even if there are no links."}],["$","h3",null,{"className":"content-header","id":"containers-have-domain-names","children":[["$","a",null,{"className":"break-words","href":"#containers-have-domain-names","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Containers have domain names"]}],["$","p",null,{"children":["Very useful that we don't need to know the ip of a container, instead Docker gives it a domain name available within it's own virtual network. The name is based on the provided ",["$","code",null,{"children":"container_name"}],". In our case ",["$","code",null,{"children":"bucket_list_service"}],"."]}],["$","p",null,{"children":["If we look into ",["$","code",null,{"children":"server.js"}],", the express app is still trying to connect to mongodb locally ( on ",["$","code",null,{"children":"localhost"}],"). ",["$","strong",null,{"children":"localhost"}]," now means that individual container... but our mongod runs in a separate container."]}],["$","$L19",null,{"className":"language-javascript","children":["$","code",null,{"className":"code-highlight language-javascript","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"// server.js"}],"\n"]}],["$","span",null,{"className":"code-line","children":["mongoose",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function property-access method","children":"connect"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"'mongodb://localhost:27017/signups'"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}]]}]}],["$","p",null,{"children":["There is no MongoDB server running on localhost within that container, so we need to ask it to connect to the ",["$","code",null,{"children":"mongoservice"}]," container instead."]}],["$","p",null,{"children":"Change this to:"}],["$","$L19",null,{"className":"language-javascript","children":["$","code",null,{"className":"code-highlight language-javascript","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token comment","children":"// server.js"}],"\n"]}],["$","span",null,{"className":"code-line","children":["mongoose",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token function property-access method","children":"connect"}],["$","span",null,{"className":"token punctuation","children":"("}],["$","span",null,{"className":"token string","children":"'mongodb://mongoservice:27017/signups'"}],["$","span",null,{"className":"token punctuation","children":")"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","p",null,{"children":"Build:"}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"docker-compose"}]," build\n"]}]}]}],["$","p",null,{"children":"Launch:"}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"docker-compose"}]," up\n"]}]}]}],["$","h4",null,{"className":"content-header","id":"other-docker-compose-options","children":[["$","a",null,{"className":"break-words","href":"#other-docker-compose-options","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Other Docker Compose options"]}],["$","p",null,{"children":"It's possible to run docker-compose in detached mode:"}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"docker-compose"}]," up ",["$","span",null,{"className":"token parameter variable","children":"-d"}],"\n"]}]}]}],["$","p",null,{"children":"It's possible to ask it to build before bring-up:"}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"docker-compose"}]," up ",["$","span",null,{"className":"token parameter variable","children":"--build"}]," ",["$","span",null,{"className":"token parameter variable","children":"-d"}],"\n"]}]}]}],["$","p",null,{"children":"Once some containers are running in docker-compose we can see them and check their status:"}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"docker-compose"}]," ",["$","span",null,{"className":"token function","children":"ps"}],"\n"]}]}]}],["$","p",null,{"children":"it will show output like:"}],["$","$L19",null,{"className":"language-js","children":["$","code",null,{"className":"code-highlight language-js","children":[["$","span",null,{"className":"code-line","children":["       ",["$","span",null,{"className":"token maybe-class-name","children":"Name"}],"                      ",["$","span",null,{"className":"token maybe-class-name","children":"Command"}],"               ",["$","span",null,{"className":"token maybe-class-name","children":"State"}],"            ",["$","span",null,{"className":"token maybe-class-name","children":"Ports"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"--"}],["$","span",null,{"className":"token operator","children":"-"}],"\n"]}],["$","span",null,{"className":"code-line","children":["bucket_list_service   npm start                        ",["$","span",null,{"className":"token maybe-class-name","children":"Up"}],"      ",["$","span",null,{"className":"token number","children":"0.0"}],["$","span",null,{"className":"token number","children":".0"}],["$","span",null,{"className":"token number","children":".0"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"3000"}],["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token operator","children":">"}],["$","span",null,{"className":"token number","children":"3000"}],["$","span",null,{"className":"token operator","children":"/"}],"tcp\n"]}],["$","span",null,{"className":"code-line","children":["mongoservice          docker",["$","span",null,{"className":"token operator","children":"-"}],"entrypoint",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"sh"}]," mongo ",["$","span",null,{"className":"token operator spread","children":"..."}],"   ",["$","span",null,{"className":"token maybe-class-name","children":"Up"}],"      ",["$","span",null,{"className":"token number","children":"0.0"}],["$","span",null,{"className":"token number","children":".0"}],["$","span",null,{"className":"token number","children":".0"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"27017"}],["$","span",null,{"className":"token operator","children":"-"}],["$","span",null,{"className":"token operator","children":">"}],["$","span",null,{"className":"token number","children":"27017"}],["$","span",null,{"className":"token operator","children":"/"}],"tcp\n"]}]]}]}],["$","p",null,{"children":"To bring containers down:"}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"docker-compose"}]," down\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","p",null,{"children":["Try it: ",["$","a",null,{"className":"break-words","target":"_blank","rel":"noopener noreferrer","href":"http://localhost:3000/","children":"http://localhost:3000/"}]," IT WORKS!"]}],["$","p",null,{"children":["We can still connect to the mongodb with Compass as if it were on ",["$","code",null,{"children":"localhost"}],"."]}],["$","hr",null,{}],["$","h2",null,{"className":"content-header","id":"recap-so-far","children":[["$","a",null,{"className":"break-words","href":"#recap-so-far","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Recap so far"]}],["$","p",null,{"children":"So far we've managed to:"}],["$","ul",null,{"children":[["$","li",null,{"children":["$","strong",null,{"children":"Learned that containers are small operating systems running independently within a host."}]}],["$","li",null,{"children":["$","strong",null,{"children":"Create a docker image for our bucket-list express app."}]}],["$","li",null,{"children":["$","strong",null,{"children":"Create a docker-compose that allows building and running of the bucket-list image along with a pre-built mongod image."}]}]]}],["$","h2",null,{"className":"content-header","id":"run-the-front-end-server-in-a-container","children":[["$","a",null,{"className":"break-words","href":"#run-the-front-end-server-in-a-container","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Run the front-end server in a container"]}],["$","p",null,{"children":"We need somewhere to serve the front-end from. For this we have a couple of options:"}],["$","ul",null,{"children":[["$","li",null,{"children":"use express static serve to serve it from where the back-end runs. This is a nice solution, as it doesn't cause any CORS issues, but not increddibly robust."}],["$","li",null,{"children":"Serve it on a totally different server on a different domain. This is common practice these days but will lead to CORS issues that we'll need to configure around in the server."}],["$","li",null,{"children":"Host it in another container on our machine using NGINX"}]]}],["$","h2",null,{"className":"content-header","id":"nginx","children":[["$","a",null,{"className":"break-words","href":"#nginx","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"NGINX"]}],["$","p",null,{"children":[["$","strong",null,{"children":"Nginx"}]," is a hiligly configurable web-server. It's a very robust server for use in production environments for many different things. We will run a Docker container with NGINX running in it. We'll give it the static files from our front-end to serve up from there."]}],["$","$L19",null,{"className":"language-js","children":["$","code",null,{"className":"code-highlight language-js","children":[["$","span",null,{"className":"code-line","children":["#docker",["$","span",null,{"className":"token operator","children":"-"}],"compose",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token property-access","children":"yml"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token literal-property property","children":"nginx"}],["$","span",null,{"className":"token operator","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token literal-property property","children":"image"}],["$","span",null,{"className":"token operator","children":":"}]," nginx",["$","span",null,{"className":"token operator","children":":"}],"latest\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token literal-property property","children":"container_name"}],["$","span",null,{"className":"token operator","children":":"}]," nginx\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token literal-property property","children":"restart"}],["$","span",null,{"className":"token operator","children":":"}]," always\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token literal-property property","children":"volumes"}],["$","span",null,{"className":"token operator","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token operator","children":"-"}]," ",["$","span",null,{"className":"token punctuation","children":"."}],["$","span",null,{"className":"token operator","children":"/"}],"client",["$","span",null,{"className":"token operator","children":"/"}],"dist",["$","span",null,{"className":"token operator","children":"/"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token operator","children":"/"}],"usr",["$","span",null,{"className":"token operator","children":"/"}],"share",["$","span",null,{"className":"token operator","children":"/"}],"nginx",["$","span",null,{"className":"token operator","children":"/"}],"html\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token literal-property property","children":"ports"}],["$","span",null,{"className":"token operator","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token operator","children":"-"}]," ",["$","span",null,{"className":"token number","children":"8080"}],["$","span",null,{"className":"token operator","children":":"}],["$","span",null,{"className":"token number","children":"80"}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","p",null,{"children":["The location ",["$","code",null,{"children":"/usr/share/nginx/html"}]," is where the nginx container will serve its static web content from."]}],["$","p",null,{"children":["We therefore need to put our built Vue app into ",["$","code",null,{"children":"./client/dist"}]," so that it can be served into that container under ",["$","code",null,{"children":"/usr/share/nginx/html"}]," - which will be picked up by nginx and hosted from there under port ",["$","code",null,{"children":"80"}],"."]}],["$","p",null,{"children":[["$","strong",null,{"children":"Now"}]," brining the services down, re-building, and ",["$","strong",null,{"children":"updating"}]," them will launch the nginx container, too."]}],["$","$L19",null,{"className":"language-js","children":["$","code",null,{"className":"code-highlight language-js","children":[["$","span",null,{"className":"code-line","children":["docker",["$","span",null,{"className":"token operator","children":"-"}],"compose down\n"]}],["$","span",null,{"className":"code-line","children":["docker",["$","span",null,{"className":"token operator","children":"-"}],"compose build\n"]}],["$","span",null,{"className":"code-line","children":["docker",["$","span",null,{"className":"token operator","children":"-"}],"compose up ",["$","span",null,{"className":"token operator","children":"-"}],"d\n"]}]]}]}],["$","p",null,{"children":["We should be able to go to ",["$","code",null,{"children":"localhost:8081"}]," - but this won't show anything as it's not got anything populated in the host folder."]}],["$","$L19",null,{"className":"language-js","children":["$","code",null,{"className":"code-highlight language-js","children":[["$","span",null,{"className":"code-line","children":"cd client\n"}],["$","span",null,{"className":"code-line","children":"npm run build\n"}]]}]}],["$","p",null,{"children":["This will put the built client code into ",["$","code",null,{"children":"dist"}],". From here it will be picked up by the nginx container so it can get hosted."]}],["$","p",null,{"children":[["$","strong",null,{"children":"Update the running container"}]," We need to restart ",["$","strong",null,{"children":"nginx"}]," for this to work.. so now do"]}],["$","$L19",null,{"className":"language-js","children":["$","code",null,{"className":"code-highlight language-js","children":[["$","span",null,{"className":"code-line","children":["docker",["$","span",null,{"className":"token operator","children":"-"}],"compose down\n"]}],["$","span",null,{"className":"code-line","children":["docker",["$","span",null,{"className":"token operator","children":"-"}],"compose build\n"]}],["$","span",null,{"className":"code-line","children":["docker",["$","span",null,{"className":"token operator","children":"-"}],"compose up ",["$","span",null,{"className":"token operator","children":"-"}],"d\n"]}]]}]}],["$","p",null,{"children":["Refresh ",["$","code",null,{"children":"http://localhost:8081"}],"."]}],["$","h2",null,{"className":"content-header","id":"update-the-front-end-to-point-to-the-containers-rather-than-localhost","children":[["$","a",null,{"className":"break-words","href":"#update-the-front-end-to-point-to-the-containers-rather-than-localhost","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Update the front-end to point to the containers rather than localhost"]}],["$","hr",null,{}],["$","h2",null,{"className":"content-header","id":"configuration-managment--deployment","children":[["$","a",null,{"className":"break-words","href":"#configuration-managment--deployment","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Configuration Managment + Deployment"]}],["$","p",null,{"children":"We've got a few problems to solve before we think about deploying this to DigitalOcean."}],["$","ul",null,{"children":[["$","li",null,{"children":["We need to change the ",["$","code",null,{"children":"MongoClient.connect('mongodb://mongoservice:27017') "}],"line depending on whether we're developing or deploying to production."]}],["$","li",null,{"children":"We need to ensure that the webpack bundler has done it's job so the bundle is up to date."}],["$","li",null,{"children":"We need something that will help us actually ask our remote server to build and run the containers remotely."}]]}],["$","p",null,{"children":["We can solve these problems with ",["$","strong",null,{"children":"Configuration Management"}]," We will specifically use ",["$","strong",null,{"children":"Ansible Playbook"}],"."]}],["$","p",null,{"children":"Ansible is a tool for doing exactly that. It allows us to run commands remotely on a remote server. Just needs SSH."}],["$","p",null,{"children":"First we need somewhere to run this.. lets use Digital Ocean.."}],["$","h3",null,{"className":"content-header","id":"setting-up-a-new-droplet","children":[["$","a",null,{"className":"break-words","href":"#setting-up-a-new-droplet","aria-hidden":"true","tabIndex":"-1","children":["$","span",null,{"className":"content-header-link","children":["$","svg",null,{"className":"h-5 linkicon w-5","fill":"currentColor","viewBox":"0 0 20 20","xmlns":"http://www.w3.org/2000/svg","children":[["$","path",null,{"d":"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z"}],["$","path",null,{"d":"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z"}]]}]}]}],"Setting up a new 'Droplet'"]}],["$","p",null,{"children":["$","strong",null,{"children":"Add our ssh key to DigitalOcean"}]}],["$","ul",null,{"children":[["$","li",null,{"children":"Click avatar top right > Account"}],["$","li",null,{"children":"Security > SSH keys > Add SSH Key"}],["$","li",null,{"children":[["$","code",null,{"children":"pbcopy < ~/.ssh/id_rsa.pub"}]," and paste into window on Digital Ocean"]}],["$","li",null,{"children":"Give name and save."}]]}],["$","p",null,{"children":["$","strong",null,{"children":"Creating the droplet"}]}],["$","p",null,{"children":"In the DO Dashboard do:"}],["$","ul",null,{"children":[["$","li",null,{"children":"Create > Droplet"}],["$","li",null,{"children":"One-click-apps > Docker"}],["$","li",null,{"children":"Choose a size > $5/month"}],["$","li",null,{"children":"Choose a region > London"}],["$","li",null,{"children":"Add SSH Key"}],["$","li",null,{"children":"Choose a hostname > pick something better"}],["$","li",null,{"children":"Press Create"}],["$","li",null,{"children":"It will take a minute to create."}],["$","li",null,{"children":"Copy the IP Address once it's ready"}]]}],["$","p",null,{"children":["$","strong",null,{"children":"Connect remotely and setup a user"}]}],["$","p",null,{"children":"We now need to remote into that droplet and check it has everything we need."}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token function","children":"ssh"}]," root@",["$","span",null,{"className":"token operator","children":"<"}],"your droplets IP",["$","span",null,{"className":"token operator","children":">"}],"\n"]}]}]}],["$","p",null,{"children":["Check we have docker installed with ",["$","code",null,{"children":"docker"}]," and ",["$","code",null,{"children":"docker-compose"}],". Looks good."]}],["$","p",null,{"children":["$","strong",null,{"children":"We will now add a user who has the correct privelages"}]}],["$","ul",null,{"children":[["$","li",null,{"children":["$","code",null,{"children":"adduser appuser"}]}],["$","li",null,{"children":"Put in a password but nothing else, just press enter..."}],["$","li",null,{"children":["$","code",null,{"children":"usermod -aG sudo appuser"}]}],["$","li",null,{"children":[["$","code",null,{"children":"su - appuser"}]," - become appuser for a minute"]}],["$","li",null,{"children":[["$","code",null,{"children":"sudo ls -la /root"}]," - enter the password and should list stuff - all good."]}],["$","li",null,{"children":[["$","code",null,{"children":"exit"}]," - back to root user"]}],["$","li",null,{"children":["$","code",null,{"children":"cp -r /root/.ssh /home/appuser"}]}],["$","li",null,{"children":[["$","code",null,{"children":"chown -R appuser:appuser ~appuser/.ssh"}]," - copy the key to the user"]}],["$","li",null,{"children":["$","code",null,{"children":"exit"}]}],["$","li",null,{"children":["We should now be able to ",["$","code",null,{"children":"ssh appuser@<droplet ip>"}]," and get in without any hassle."]}]]}],["$","p",null,{"children":["$","strong",null,{"children":"Install ansible"}]}],["$","ul",null,{"children":[["$","li",null,{"children":["$","code",null,{"children":"sudo apt update"}]}],["$","li",null,{"children":["$","code",null,{"children":"sudo apt install software-properties-common"}]}],["$","li",null,{"children":[["$","code",null,{"children":"sudo apt-add-repository ppa:ansible/ansible"}]," - press enter"]}],["$","li",null,{"children":["$","code",null,{"children":"sudo apt update"}]}],["$","li",null,{"children":["$","code",null,{"children":"sudo apt install ansible"}]}],["$","li",null,{"children":["$","code",null,{"children":"sudo apt intstall python python-pip"}]}]]}],["$","p",null,{"children":["$","strong",null,{"children":"Enable docker for appuser"}]}],["$","ul",null,{"children":["$","li",null,{"children":["$","code",null,{"children":"sudo usermod -aG docker ${USER}"}]}]}],["$","p",null,{"children":["$","strong",null,{"children":"Create the ansible config locally"}]}],["$","p",null,{"children":["Create a directory called ",["$","code",null,{"children":"deployment"}],". We will put all deployment related configs in here."]}],["$","p",null,{"children":["In deployment create a ",["$","code",null,{"children":"bucketlistservice.yml"}],"."]}],["$","$L19",null,{"className":"language-yaml","children":["$","code",null,{"className":"code-highlight language-yaml","children":[["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"-"}]," ",["$","span",null,{"className":"token atrule key","children":"hosts"}],["$","span",null,{"className":"token punctuation","children":":"}]," bucketlistbackend\n"]}],["$","span",null,{"className":"code-line","children":["  ",["$","span",null,{"className":"token atrule key","children":"tasks"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token punctuation","children":"-"}]," ",["$","span",null,{"className":"token atrule key","children":"name"}],["$","span",null,{"className":"token punctuation","children":":"}]," Copy app",["$","span",null,{"className":"token punctuation","children":"-"}],"services files across\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token atrule key","children":"synchronize"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token atrule key","children":"src"}],["$","span",null,{"className":"token punctuation","children":":"}]," ../services/\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token atrule key","children":"dest"}],["$","span",null,{"className":"token punctuation","children":":"}]," /home/appuser/services\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token atrule key","children":"mode"}],["$","span",null,{"className":"token punctuation","children":":"}]," push\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token atrule key","children":"rsync_opts"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["            ",["$","span",null,{"className":"token punctuation","children":"-"}]," ",["$","span",null,{"className":"token string","children":"\"--exclude=node_modules\""}],"\n"]}],["$","span",null,{"className":"code-line","children":"\n"}],["$","span",null,{"className":"code-line","children":["    ",["$","span",null,{"className":"token punctuation","children":"-"}]," ",["$","span",null,{"className":"token atrule key","children":"name"}],["$","span",null,{"className":"token punctuation","children":":"}]," Bring up the rest of the services\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token atrule key","children":"command"}],["$","span",null,{"className":"token punctuation","children":":"}]," docker",["$","span",null,{"className":"token punctuation","children":"-"}],"compose up ",["$","span",null,{"className":"token punctuation","children":"-"}],"d ",["$","span",null,{"className":"token punctuation","children":"-"}],["$","span",null,{"className":"token punctuation","children":"-"}],"build\n"]}],["$","span",null,{"className":"code-line","children":["      ",["$","span",null,{"className":"token atrule key","children":"args"}],["$","span",null,{"className":"token punctuation","children":":"}],"\n"]}],["$","span",null,{"className":"code-line","children":["        ",["$","span",null,{"className":"token atrule key","children":"chdir"}],["$","span",null,{"className":"token punctuation","children":":"}]," /home/appuser/services/\n"]}],["$","span",null,{"className":"code-line","children":"\n"}]]}]}],["$","p",null,{"children":["Create a ",["$","code",null,{"children":"hosts"}]," file in the ",["$","code",null,{"children":"deployment"}]," directory (same directory as the ",["$","code",null,{"children":"bucketlistservice.yml"}],"."]}],["$","$L19",null,{"className":"language-js","children":["$","code",null,{"className":"code-highlight language-js","children":[["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token punctuation","children":"["}],"bucketlistbackend",["$","span",null,{"className":"token punctuation","children":"]"}],"\n"]}],["$","span",null,{"className":"code-line","children":[["$","span",null,{"className":"token operator","children":"<"}],"your server's ip",["$","span",null,{"className":"token operator","children":">"}],"\n"]}]]}]}],["$","p",null,{"children":["$","strong",null,{"children":"Deploy with Ansible"}]}],["$","$L19",null,{"className":"language-bash","children":["$","code",null,{"className":"code-highlight language-bash","children":["$","span",null,{"className":"code-line","children":["ansible-playbook ",["$","span",null,{"className":"token parameter variable","children":"-i"}]," hosts ",["$","span",null,{"className":"token parameter variable","children":"-u"}]," appuser bucketlistservice.yml\n"]}]}]}],["$","p",null,{"children":["Now check the app is working: ",["$","code",null,{"children":"<server ip>:3000"}]," in the browser."]}]]}],["$","div",null,{"className":"pb-6 pt-6 text-sm text-gray-700 dark:text-gray-300","children":[["$","a",null,{"className":"break-words","target":"_blank","rel":"nofollow","href":"https://mobile.twitter.com/search?q=https%3A%2F%2Fcolin-riddell.github.io%2F%2Fblog%2Fdocker-intro-with-do","children":"Discuss on Twitter"}]," • ",["$","a",null,{"className":"break-words","target":"_blank","rel":"noopener noreferrer","href":"https://github.com/colin-riddell/new-blog2/blob/main/data/blog/docker-intro-with-do.mdx","children":"View on GitHub"}]]}],["$","div",null,{"className":"pb-6 pt-6 text-center text-gray-700 dark:text-gray-300","id":"comment","children":["$","$L1a",null,{"slug":"docker-intro-with-do"}]}]]}],["$","footer",null,{"children":[["$","div",null,{"className":"divide-gray-200 text-sm font-medium leading-5 dark:divide-gray-700 xl:col-start-1 xl:row-start-2 xl:divide-y","children":[["$","div",null,{"className":"py-4 xl:py-8","children":[["$","h2",null,{"className":"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400","children":"Tags"}],["$","div",null,{"className":"flex flex-wrap","children":[["$","$L9","docker",{"href":"/tags/docker","className":"mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":"docker"}],["$","$L9","DigitalOcean",{"href":"/tags/digitalocean","className":"mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":"DigitalOcean"}],["$","$L9","cloud",{"href":"/tags/cloud","className":"mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":"cloud"}],["$","$L9","devops",{"href":"/tags/devops","className":"mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":"devops"}]]}]]}],["$","div",null,{"className":"flex justify-between py-4 xl:block xl:space-y-8 xl:py-8","children":["$undefined",["$","div",null,{"children":[["$","h2",null,{"className":"text-xs uppercase tracking-wide text-gray-500 dark:text-gray-400","children":"Next Article"}],["$","div",null,{"className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","children":["$","$L9",null,{"className":"break-words","href":"/blog/starting-with-scala","children":"Starting With Scala"}]}]]}]]}]]}],["$","div",null,{"className":"pt-4 xl:pt-8","children":["$","$L9",null,{"className":"text-primary-500 hover:text-primary-600 dark:hover:text-primary-400","href":"/blog","aria-label":"Back to the blog","children":"← Back to the blog"}]}]]}]]}]]}]}]]}]]
15:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
13:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Deploying to Cloud with DigitalOcean + Docker | Colin Riddell - Blog"}],["$","meta","2",{"name":"robots","content":"index, follow"}],["$","meta","3",{"name":"googlebot","content":"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"}],["$","link","4",{"rel":"canonical","href":"https://colin-riddell.github.io/blog/docker-intro-with-do"}],["$","link","5",{"rel":"alternate","type":"application/rss+xml","href":"https://colin-riddell.github.io//feed.xml"}],["$","meta","6",{"property":"og:title","content":"Deploying to Cloud with DigitalOcean + Docker"}],["$","meta","7",{"property":"og:url","content":"https://colin-riddell.github.io/blog/docker-intro-with-do"}],["$","meta","8",{"property":"og:site_name","content":"Colin Riddell - Blog"}],["$","meta","9",{"property":"og:locale","content":"en_US"}],["$","meta","10",{"property":"og:image","content":"https://colin-riddell.github.io//static/images/twitter-card.png"}],["$","meta","11",{"property":"og:type","content":"article"}],["$","meta","12",{"property":"article:published_time","content":"2019-09-19T17:19:14.000Z"}],["$","meta","13",{"property":"article:modified_time","content":"2019-09-19T17:19:14.000Z"}],["$","meta","14",{"property":"article:author","content":"Colin Riddell"}],["$","meta","15",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","16",{"name":"twitter:title","content":"Deploying to Cloud with DigitalOcean + Docker"}],["$","meta","17",{"name":"twitter:image","content":"https://colin-riddell.github.io/static/images/twitter-card.png"}]]
11:null
